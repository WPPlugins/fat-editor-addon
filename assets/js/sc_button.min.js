var fat_sc_button={attr:"",activeEditor:null};!function(a){"use strict";fat_sc_button.init=function(){fat_sc_button.init_button()},fat_sc_button.init_button=function(){tinymce.create("tinymce.plugins.fat_sc_video_button_plugin",{init:function(a,b){a.addCommand("fat_sc_video_button_insert_shortcode",function(){fat_sc_button.open_popup_shortcode()}),a.addButton("fat_sc_video_button",{title:"Video embed shortcode",cmd:"fat_sc_video_button_insert_shortcode",image:b+"/../images/video-player-icon.png"})}}),tinymce.PluginManager.add("fat_sc_video_button",tinymce.plugins.fat_sc_video_button_plugin),tinymce.create("tinymce.plugins.fat_sc_twitter_button_plugin",{init:function(a,b){a.addCommand("fat_sc_twitter_button_insert_shortcode",function(){fat_sc_button.open_popup_twitter_shortcode()}),a.addButton("fat_sc_twitter_button",{title:"Insert twitter shortcode",cmd:"fat_sc_twitter_button_insert_shortcode",image:b+"/../images/twitter-icon.png"})}}),tinymce.PluginManager.add("fat_sc_twitter_button",tinymce.plugins.fat_sc_twitter_button_plugin),tinymce.create("tinymce.plugins.fat_sc_highlight_button_plugin",{init:function(a,b){a.addCommand("fat_sc_highlight_button_insert_shortcode",function(){fat_sc_button.open_popup_highlight_shortcode()}),a.addButton("fat_sc_highlight_button",{title:"Insert highlight shortcode",cmd:"fat_sc_highlight_button_insert_shortcode",image:b+"/../images/highlight-icon.png"})}}),tinymce.PluginManager.add("fat_sc_highlight_button",tinymce.plugins.fat_sc_highlight_button_plugin),tinymce.create("tinymce.plugins.fat_sc_image_button_plugin",{init:function(a,b){a.addCommand("fat_sc_image_button_insert_shortcode",function(){fat_sc_button.open_popup_image_shortcode()}),a.addButton("fat_sc_image_button",{title:"Insert image shortcode",cmd:"fat_sc_image_button_insert_shortcode",image:b+"/../images/image-icon.png"})}}),tinymce.PluginManager.add("fat_sc_image_button",tinymce.plugins.fat_sc_image_button_plugin)},fat_sc_button.open_popup_shortcode=function(){var b,c,d,e,f,g,h,i=a('<div class="fat-shortcode-popup"></div>'),b=[{param_name:"video_type",options:{youtube:"Youtube",vimeo:"Vimeo"},value:"youtube",type:"select",label:"Video type"},{param_name:"video_id",value:"",type:"text",label:"Video Id"},{param_name:"dimension",options:{width:"Width",height:"Height"},value:"width",type:"select",label:"Dimension"},{param_name:"dimension_value",value:"",type:"number",label:"Dimension value"},{param_name:"video_position",options:{"text-center":"Center","text-left":"Left","text-right":"right"},value:"text-left",type:"select",label:"Video position"},{param_name:"enable_video_icon",options:{1:"Enable"},value:"1",type:"checkbox",label:"Video icon"},{param_name:"autoplay",options:{1:"Enable"},value:"0",type:"checkbox",label:"Auto play"},{param_name:"allow_full_screen",options:{1:"Enable"},value:"0",type:"checkbox",label:"Allow full screen"},{param_name:"showinfo",options:{1:"Enable"},value:"0",type:"checkbox",label:"Show info"},{param_name:"showcontrol",options:{1:"Enable"},value:"0",type:"checkbox",label:"Show video control"}];fat_sc_button.attr=fat_sc_button.get_sc_attr_from_content(),h=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,"fat_sc_id"),h="undefined"==typeof h||""===h||null==h?fat_sc_button.guid():h;for(var j=0;j<b.length;j++){switch(c="",b[j].type){case"text":c=wp.template("fat-text-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_description:b[j].description}));break;case"number":c=wp.template("fat-number-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),e="undefined"!=typeof b[j].max?'max="'+b[j].max+'"':"",f="undefined"!=typeof b[j].min?'min="'+b[j].min+'"':"",g="undefined"!=typeof b[j].step?'step="'+b[j].min+'"':"",c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_max:e,field_min:f,field_step:g}));break;case"checkbox":c=wp.template("fat-checkbox-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),null==d&&(d=b[j].value),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_options:b[j].options,field_value:d,field_description:b[j].description}));break;case"radio":c=wp.template("fat-radio-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),null==d&&(d=b[j].value),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_options:b[j].options,field_value:d,field_description:b[j].description}));break;case"select":c=wp.template("fat-select-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_options:b[j].options,field_value:d,field_description:b[j].description,field_multiple:b[j].multiple}));break;case"color":c=wp.template("fat-color-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_description:b[j].description}))}i.append(c)}sc_utils.showPopup(h,"Video embed shortcode",i,function(){fat_sc_button.initFieldScript(),a("a.fat-sc-popup-bt-insert").off("click").on("click",function(){fat_sc_button.save_to_editor(h,b)})})},fat_sc_button.open_popup_twitter_shortcode=function(){var b,c,d,e,f,g,h,i=a('<div class="fat-shortcode-popup"></div>'),b=[{param_name:"content",value:"",type:"text",label:"Content to share"},{param_name:"link",value:"",type:"text",label:"Link to share",description:"Set empty to share this post"},{param_name:"icon_font_size",value:"14",type:"number",label:"Icon font size (pixel)"},{param_name:"text_color",value:"",type:"color",label:"Text color"},{param_name:"text_hover_color",value:"",type:"color",label:"Text hover color"},{param_name:"underline_hover_color",value:"",type:"color",label:"Text underline hover color"},{param_name:"underline_hover_width",value:"",type:"number",label:"Text underline hover width"}];fat_sc_button.attr=fat_sc_button.get_sc_twitter_attr_from_content(),e=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,"fat_sc_id"),e="undefined"==typeof e||""===e||null==e?fat_sc_button.guid():e;for(var j=0;j<b.length;j++){switch(c="",b[j].type){case"text":c=wp.template("fat-text-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_description:b[j].description}));break;case"number":c=wp.template("fat-number-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),f="undefined"!=typeof b[j].max?'max="'+b[j].max+'"':"50",g="undefined"!=typeof b[j].min?'min="'+b[j].min+'"':"10",h="undefined"!=typeof b[j].step?'step="'+b[j].min+'"':"1",d=null!=d?d:b[j].value,c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_max:f,field_min:g,field_step:h}));break;case"color":c=wp.template("fat-color-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_description:b[j].description}))}i.append(c)}sc_utils.showPopup(e,"Twitter share shortcode",i,function(){fat_sc_button.initFieldScript(),a("a.fat-sc-popup-bt-insert").off("click").on("click",function(){fat_sc_button.save_twitter_to_editor(e,b)})})},fat_sc_button.open_popup_highlight_shortcode=function(){var b,c,d,e,f,g,h,i=a('<div class="fat-shortcode-popup"></div>'),b=[{param_name:"content",value:"",type:"text",label:"Content"},{param_name:"link",value:"",type:"text",label:"Link",description:"Set empty to get link this post"},{param_name:"open_type",options:{_self:"Same window",_blank:"New window or tab"},value:"_self",type:"select",label:"Open type"},{param_name:"font_style",options:{normal:"Normal",italic:"Italic"},value:"normal",type:"select",label:"Font style"},{param_name:"text_color",value:"",type:"color",label:"Text color"},{param_name:"underline_color",value:"",type:"color",label:"Text underline color"},{param_name:"underline_width",value:"2",type:"number",label:"Text underline width"},{param_name:"background_color",value:"",type:"color",label:"Text background color"},{param_name:"font_style_hover",options:{normal:"Normal",italic:"Italic"},value:"normal",type:"select",label:"Font style hover"},{param_name:"text_hover_color",value:"",type:"color",label:"Text hover color"},{param_name:"underline_hover_color",value:"",type:"color",label:"Text underline hover color"},{param_name:"background_hover_color",value:"",type:"color",label:"Text background hover color"}];fat_sc_button.attr=fat_sc_button.get_sc_highlight_attr_from_content(),e=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,"fat_sc_id"),e="undefined"==typeof e||""===e||null==e?fat_sc_button.guid():e;for(var j=0;j<b.length;j++){switch(c="",b[j].type){case"text":c=wp.template("fat-text-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_description:b[j].description}));break;case"number":c=wp.template("fat-number-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),f="undefined"!=typeof b[j].max?'max="'+b[j].max+'"':"50",g="undefined"!=typeof b[j].min?'min="'+b[j].min+'"':"10",h="undefined"!=typeof b[j].step?'step="'+b[j].min+'"':"1",d=null!=d?d:b[j].value,c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_max:f,field_min:g,field_step:h}));break;case"select":c=wp.template("fat-select-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_options:b[j].options,field_value:d,field_description:b[j].description,field_multiple:b[j].multiple}));break;case"color":c=wp.template("fat-color-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[j].param_name),c=a(c({field_label:b[j].label,field_id:b[j].param_name,field_name:b[j].param_name,field_std:b[j].value,field_value:d,field_description:b[j].description}))}i.append(c)}sc_utils.showPopup(e,"Highlight shortcode",i,function(){fat_sc_button.initFieldScript(),a("a.fat-sc-popup-bt-insert").off("click").on("click",function(){fat_sc_button.save_highlight_to_editor(e,b)})})},fat_sc_button.open_popup_image_shortcode=function(){var b,c,d,e,f=a('<div class="fat-shortcode-popup"></div>'),b=[{param_name:"title",value:"",type:"text",label:"Title to share",description:"Set empty to share title of post"},{param_name:"link",value:"",type:"text",label:"Link to share",description:"Set empty to share this post"},{param_name:"img_size",options:{full:"Full",medium:"Medium",thumbnail:"Thumbnail"},value:"full",type:"select",label:"Image size"},{param_name:"img_position",options:{"text-center":"Center","text-left":"Left","text-right":"Right"},value:"text-left",type:"select",label:"Image position"},{param_name:"img_id",value:"",type:"single_image",label:"Choice image"}];fat_sc_button.attr=fat_sc_button.get_sc_image_attr_from_content(),e=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,"fat_sc_id"),e="undefined"==typeof e||""===e||null==e?fat_sc_button.guid():e;for(var g=0;g<b.length;g++){switch(c="",b[g].type){case"text":c=wp.template("fat-text-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[g].param_name),c=a(c({field_label:b[g].label,field_id:b[g].param_name,field_name:b[g].param_name,field_std:b[g].value,field_value:d,field_description:b[g].description}));break;case"color":c=wp.template("fat-color-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[g].param_name),c=a(c({field_label:b[g].label,field_id:b[g].param_name,field_name:b[g].param_name,field_std:b[g].value,field_value:d,field_description:b[g].description}));break;case"select":c=wp.template("fat-select-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[g].param_name),c=a(c({field_label:b[g].label,field_id:b[g].param_name,field_name:b[g].param_name,field_std:b[g].value,field_options:b[g].options,field_value:d,field_description:b[g].description,field_multiple:b[g].multiple}));break;case"single_image":if(c=wp.template("fat-single-image-field"),d=fat_sc_button.getParamValueFromAttr(fat_sc_button.attr,b[g].param_name),c=a(c({field_label:b[g].label,field_id:b[g].param_name,field_name:b[g].param_name,field_std:b[g].value,field_value:d,field_description:b[g].description})),""!==d&&null!=d){var h='.fat-sc-popup-content .fat-add-single-image-wrap div[data-input-id="'+b[g].param_name+'"]';sc_utils.bindImageItem(b[g].param_name,d,"fat-single-image-item",h)}}f.append(c)}sc_utils.showPopup(e,"Image shortcode",f,function(){fat_sc_button.initFieldScript(),a("a.fat-sc-popup-bt-insert").off("click").on("click",function(){fat_sc_button.save_image_to_editor(e,b)})})},fat_sc_button.initFieldScript=function(){a(".fat-cmb-select",".fat-sc-popup-content").each(function(){var b=a(this).attr("data-selected");"undefined"!=typeof b&&""!==b&&a(this).val(b)}),a(".fat-sc-popup-content .fat-cmb-color-picker").wpColorPicker(),a("a.fat-add-single-image",".fat-sc-popup-dialog .fat-add-single-image-wrap").off("click").on("click",function(b){b.preventDefault(),wp.media.frames.gk_frame=wp.media({title:"Select Image",multiple:!1,library:{type:"image"}}),wp.media.frames.gk_frame.clicked_button=a(this),wp.media.frames.gk_frame.open().on("select",function(b){var c,d,e,f,g,h=wp.media.frames.gk_frame.state().get("selection");g=a(wp.media.frames.gk_frame.clicked_button).attr("data-input-id"),h.each(function(b){f='<div class="fat-image-thumb" data-id="%id" ><img src="%thumbnail" /><div class="fat-overlay fat-transition-30"><span><a class="fat-delete-single-image" data-id="%id" href="javascript:;"><i class="dashicons dashicons-no-alt"></i></a></span></div></div>',c="undefined"!=typeof b.attributes.sizes.thumbnail?b.attributes.sizes.thumbnail.url:b.attributes.url,d=b.attributes.id,e=a(wp.media.frames.gk_frame.clicked_button).closest(".fat-add-single-image-wrap"),f=f.replace("%thumbnail",c),f=f.replace(/%id/g,d),a('[data-id="'+d+'"]',e).length<=0&&(a(".fat-list-image",e).empty(),a(".fat-list-image",e).append(f))}),a("a.fat-delete-single-image",e).on("click",function(){a('input[data-field-type="single-image"]',e).val(),a(".fat-list-image .fat-image-thumb",e).remove()}),a("#"+g).val(d)})})},fat_sc_button.get_sc_attr_from_content=function(){var a,b=tinyMCE.activeEditor.selection.getRng(!0).startOffset,c=tinyMCE.activeEditor.selection.getSel().anchorNode.wholeText,d=/\[(fat_video_embed)(?!_)(?![\\w-])([^\]]*(?:\/(?!\])[^\]\/]*)*?).*?\[\/\1\]/g,e="";for(fat_sc_button.activeEditor=tinyMCE.activeEditor;a=d.exec(c);)b>a.index&&(e=a[2]),d.lastIndex=a.index+1;return 0==e.indexOf(" ")?e.replace(" ",""):e},fat_sc_button.get_sc_twitter_attr_from_content=function(){var a,b=tinyMCE.activeEditor.selection.getSel().anchorOffset,c=tinyMCE.activeEditor.selection.getSel().focusNode.length,d=tinyMCE.activeEditor.selection.getSel().focusNode.data,e=/\[(fat_twitter)(?!_)(?![\\w-])([^\]]*(?:\/(?!\])[^\]\/]*)*?).*?\[\/\1\]/g,f="";for(fat_sc_button.activeEditor=tinyMCE.activeEditor;a=e.exec(d);)c>b&&(f=a[2]),e.lastIndex=a.index+1;return 0==f.indexOf(" ")?f.replace(" ",""):f},fat_sc_button.get_sc_highlight_attr_from_content=function(){var a,b=tinyMCE.activeEditor.selection.getSel().anchorOffset,c=tinyMCE.activeEditor.selection.getSel().focusNode.length,d=tinyMCE.activeEditor.selection.getSel().focusNode.data,e=/\[(fat_highlight)(?!_)(?![\\w-])([^\]]*(?:\/(?!\])[^\]\/]*)*?).*?\[\/\1\]/g,f="";for(fat_sc_button.activeEditor=tinyMCE.activeEditor;a=e.exec(d);)c>b&&(f=a[2]),e.lastIndex=a.index+1;return 0==f.indexOf(" ")?f.replace(" ",""):f},fat_sc_button.get_sc_image_attr_from_content=function(){var a,b=tinyMCE.activeEditor.selection.getSel().anchorOffset,c=tinyMCE.activeEditor.selection.getSel().focusNode.length,d=tinyMCE.activeEditor.selection.getSel().focusNode.data,e=/\[(fat_image)(?!_)(?![\\w-])([^\]]*(?:\/(?!\])[^\]\/]*)*?).*?\[\/\1\]/g,f="";for(fat_sc_button.activeEditor=tinyMCE.activeEditor;a=e.exec(d);)c>b&&(f=a[2]),e.lastIndex=a.index+1;return 0==f.indexOf(" ")?f.replace(" ",""):f},fat_sc_button.getParamValueFromAttr=function(a,b){if("undefined"!=typeof a&&""!=a){var c=new RegExp(b+'\\s*=\\s*"(.*?)"',"gm").exec(a);return c?c[1]:null}return null},fat_sc_button.save_to_editor=function(b,c){for(var d,e,f,g=(tinyMCE.activeEditor.selection.getContent(),""),h="",i=0;i<c.length;i++)switch(d=a('[data-field-name="'+c[i].param_name+'"]',".fat-sc-popup-content"),f=d.attr("data-field-type"),e="",f){case"text":h+=" "+c[i].param_name+'="'+d.val()+'"';break;case"select":h+=null===d.val()||"undefined"==typeof d.val()?" "+c[i].param_name+'=""':" "+c[i].param_name+'="'+d.val()+'"';break;case"checkbox":a('input[name="'+c[i].param_name+'"]',".fat-sc-popup-content").each(function(){a(this).is(":checked")&&(e+=a(this).val()+",")}),e="undefined"!=typeof e?e.slice(0,-1):"",h+=" "+c[i].param_name+'="'+e+'"';break;case"radio":a('input[name="'+c[i].param_name+'"]',".fat-sc-popup-content").each(function(){a(this).is(":checked")&&(e=a(this).val())}),e="undefined"!=typeof e?e:"",h+=" "+c[i].param_name+'="'+e+'"';break;default:h+=" "+c[i].param_name+'="'+d.val()+'"'}h+=' fat_sc_id="'+b+'"',g="[fat_video_embed"+h+"][/fat_video_embed]";var j="[fat_video_embed "+fat_sc_button.attr+"][/fat_video_embed]",k=fat_sc_button.activeEditor.getContent();k=k.replace(j,g),"undefined"!=typeof fat_sc_button.attr&&""!==fat_sc_button.attr?fat_sc_button.activeEditor.setContent(k):tinymce.execCommand("mceInsertContent",!1,g),sc_utils.closePopup()},fat_sc_button.save_twitter_to_editor=function(b,c){for(var d,e,f,g=(tinyMCE.activeEditor.selection.getContent(),""),h="",i=0;i<c.length;i++)switch(d=a('[data-field-name="'+c[i].param_name+'"]',".fat-sc-popup-content"),f=d.attr("data-field-type"),e="",f){case"text":h+=" "+c[i].param_name+'="'+d.val()+'"';break;default:h+=" "+c[i].param_name+'="'+d.val()+'"'}h+=' fat_sc_id="'+b+'"',g="[fat_twitter"+h+"][/fat_twitter]";var j="[fat_twitter "+fat_sc_button.attr+"][/fat_twitter]",k=fat_sc_button.activeEditor.getContent();k=k.replace(j,g),"undefined"!=typeof fat_sc_button.attr&&""!==fat_sc_button.attr?fat_sc_button.activeEditor.setContent(k):tinymce.execCommand("mceInsertContent",!1,g),sc_utils.closePopup()},fat_sc_button.save_highlight_to_editor=function(b,c){for(var d,e,f,g=(tinyMCE.activeEditor.selection.getContent(),""),h="",i=0;i<c.length;i++)switch(d=a('[data-field-name="'+c[i].param_name+'"]',".fat-sc-popup-content"),f=d.attr("data-field-type"),e="",f){case"text":h+=" "+c[i].param_name+'="'+d.val()+'"';break;default:h+=" "+c[i].param_name+'="'+d.val()+'"'}h+=' fat_sc_id="'+b+'"',g="[fat_highlight"+h+"][/fat_highlight]";var j="[fat_highlight "+fat_sc_button.attr+"][/fat_highlight]",k=fat_sc_button.activeEditor.getContent();k=k.replace(j,g),"undefined"!=typeof fat_sc_button.attr&&""!==fat_sc_button.attr?fat_sc_button.activeEditor.setContent(k):tinymce.execCommand("mceInsertContent",!1,g),sc_utils.closePopup()},fat_sc_button.save_image_to_editor=function(b,c){for(var d,e,f,g=(tinyMCE.activeEditor.selection.getContent(),""),h="",i=0;i<c.length;i++)switch(d=a('[data-field-name="'+c[i].param_name+'"]',".fat-sc-popup-content"),f=d.attr("data-field-type"),e="",f){case"text":h+=" "+c[i].param_name+'="'+d.val()+'"';break;default:h+=" "+c[i].param_name+'="'+d.val()+'"'}h+=' fat_sc_id="'+b+'"',g="[fat_image"+h+"][/fat_image]";var j="[fat_image "+fat_sc_button.attr+"][/fat_image]",k=fat_sc_button.activeEditor.getContent();k=k.replace(j,g),"undefined"!=typeof fat_sc_button.attr&&""!==fat_sc_button.attr?fat_sc_button.activeEditor.setContent(k):tinymce.execCommand("mceInsertContent",!1,g),sc_utils.closePopup()},fat_sc_button.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"fat-video-"+a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},a(document).ready(function(){fat_sc_button.init()})}(jQuery);